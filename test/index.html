<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test</title>
</head>

<body>
  <div id="app"></div>
  <script type="module">
    import { createDomily } from "../lib/index.esm.js";

    const testCustomElements = {
      'test-element-1': class TestElement extends HTMLElement {
        shadowRoot;
        constructor() {
          super()
          this.shadowRoot = this.attachShadow({ mode: 'closed' })
        }
        connectedCallback() {
          const div = document.createElement('div')
          div.append('Test Element 1')
          this.shadowRoot.appendChild(div)
        }
      },
      'test-element-2': class TestElement extends HTMLElement {
        shadowRoot;
        constructor() {
          super()
          this.shadowRoot = this.attachShadow({ mode: 'open' })
        }
        connectedCallback() {
          const div = document.createElement('div')
          div.append("Test Element 2")
          this.shadowRoot.appendChild(div)
        }
      },
    }

    const Domily = createDomily(testCustomElements)
    const abortController = new AbortController()
    let count = 0
    const h1 = Domily.h1({
      text: '0',
      className: "title",
      style: {
        color: "red",
        fontSize: "50px",
        cursor: 'pointer'
      },
      events: {
        click: () => {
          count += 5;
          h1.schema.html = `<span style="font-size:${count < 40 ? count + 20 : count}px">${count}</span>`;
        },
      }
    });

    const p1 = Domily.p({
      domShow: true,
      domIf: true,
      text: "This is a paragraph.",
      className: "paragraph",
    })
    const pf1 = Domily.p({
      domShow: true,
      domIf: true,
      text: "This is a paragraph in fragment.",
      className: "paragraph",
    })
    const d3 = Domily.div({
      text: "d3",
    })
    const f = Domily.fragment([
      Domily.text({
        text: 'text'
      }),
      {
        tag: 'text',
        text: '1245789'
      },
      {
        tag: "div",
        text: "d1",
      },
      {
        tag: "div",
        text: "d2",
      },
      d3,
      pf1,
      Domily.button({
        id: 'f-btn-1',
        text: "button 1 - DOM Show",
        className: "button",
        events: {
          click: () => {
            d3.schema.domShow = !d3.schema.domShow;
          },
        },
      }),
      Domily.button({
        id: 'f-btn-2',
        text: "button 1 - DOM Show",
        className: "button",
        events: {
          click: () => {
            d3.schema.domIf = !d3.schema.domIf;
          },
        },
      }),
    ]);

    const x = {
      className: "test",
      children: [
        h1,
        p1,
        Domily['test-element-1']({
          style: {
            display: "block",
            color: "deepskyblue",
          },
        }),
        Domily['test-element-2']({
          style: {
            display: "block",
            color: "red",
          },
        }),
        Domily.ul({
          style: {
            'margin-block': '10px',
            outline: '2px dashed #f40'
          },
          children: new Array(10).fill(0).map((_, i) => Domily.li({
            text: `item-${i + 1}`
          }))
        }),
        Domily.button({
          id: 'btn-1',
          text: "button 1 - DOM Show",
          className: "button",
          events: {
            click: () => {
              p1.schema.domShow = !p1.schema.domShow;
            },
          },
        }),
        Domily.button({
          id: 'btn-2',
          text: "button 2 - DOM If",
          className: "button",
          events: {
            click: () => {
              p1.schema.domIf = !p1.schema.domIf;
              pf1.schema.domIf = !pf1.schema.domIf;
            },
          },
        })
      ],
    }
    const dom = Domily.div(x);
    f.mount('#app');
    dom.mount('#app');
  </script>
</body>

</html>